Version =19
VersionRequired =19
Checksum =-58816556
Begin Form
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =7380
    DatasheetFontHeight =10
    ItemSuffix =14
    Left =3795
    Top =1905
    Right =11610
    Bottom =7725
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x4fde9fa3f288e240
    End
    RecordSource ="l_tblRunningOrderEntry"
    OnCurrent ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x42726f7468657220484c2d35313730444e207365726965730000000000000000 ,
        0x010403029c00100a1f53010001000100ea0a6f08640001000700580201000100 ,
        0x5802010000004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000000000e4060000 ,
        0x5052495600200000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000001800000000001027 ,
        0x10271027000010270000000000000000e08a0d00ff0000000000020001000000 ,
        0x0200000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000050001000100000000000000 ,
        0x0001000001000000249a0200c600110009840000000000000000000000000000 ,
        0x0000000000010000000064000100bb0288040000000000000000000000000000 ,
        0x000000000000000000000000000000000000000006000000f5ffffff00000000 ,
        0x000000000000000000000000000000010000000041007200690061006c000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000ffffff0000020000 ,
        0x0000000100000000000000000100000001000000000000000000ffff00000000 ,
        0x0000000000000000000000000000000000000000000000000000000007000700 ,
        0x000000002000000001000000010000000001ffff000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000058005000580045004e000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000000000ffffffff ,
        0xfefffffffefffffffefffffffefffffffefffffffefffffffefffffffeffffff ,
        0xfefffffffefffffffefffffffefffffffefffffffefffffffefffffffeffffff ,
        0xfefffffffefffffffefffffffefffffffefffffffffffffffeffffff16070100 ,
        0x010000000000000005000000000000000000000007000000010000000000454e ,
        0x474c495348000000000000000000420052005300500032003000340041002e00 ,
        0x4500580045000000000000000000420052004c0048004c003000340041002e00 ,
        0x44004c004c000000000000000000420052004200480034003000340041002e00 ,
        0x44004c004c00000000000000000042004f00350031003700300044004e002e00 ,
        0x49004e00490000000000000000000000020000000700000000000000ec180000 ,
        0x160d00000000000029090000bb1700000000000082050000a403000000000000 ,
        0xd007000092090000000000005a14000034080000000000008e120000ec130000 ,
        0x00000000370c0000da0c000000000000d4300000d4300000d430000049020000 ,
        0x7800000000000000000000000000000010270000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000052005300500032003000340041002e0045005800450000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000070008040002000001000000000000000100ffff000000000e010000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000c600880000006400 ,
        0x0000000001410000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000006000000f5ffffff00000000000000000000000000000000 ,
        0x000000010000000041007200690061006c000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000ffffff0001000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000ffffffff6400000000000000080000806f006c00 ,
        0x73006f006e000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000002010000 ,
        0x0000000000000000000000000100000042524c484c3034412e444c4c00000000 ,
        0x0000000000000000454f5343
    End
    PrtDevNames = Begin
        0x080021003a00010042726f7468657220484c2d35313730444e20736572696573 ,
        0x0042726f7468657220484c2d35313730444e207365726965730049505f313932 ,
        0x2e3136382e302e323800
    End
    NoSaveCTIWhenDisabled =1
    Begin
        Begin Label
            BackStyle =0
        End
        Begin TextBox
            AutoLabel = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
        End
        Begin ComboBox
            SpecialEffect =2
        End
        Begin FormHeader
            Height =450
            BackColor =-2147483633
            Name ="FormHeader"
            Begin
                Begin Label
                    OverlapFlags =85
                    Left =60
                    Top =120
                    Width =465
                    Height =210
                    Name ="Label1"
                    Caption ="Order"
                End
                Begin Label
                    OverlapFlags =85
                    Left =1260
                    Top =180
                    Width =450
                    Height =210
                    Name ="Label4"
                    Caption ="Class"
                End
                Begin Label
                    OverlapFlags =85
                    Left =3000
                    Top =240
                    Width =630
                    Height =210
                    Name ="Label5"
                    Caption ="Division"
                End
                Begin Label
                    OverlapFlags =85
                    Left =4320
                    Top =120
                    Width =465
                    Height =210
                    Name ="Label6"
                    Caption ="Level"
                End
                Begin Label
                    OverlapFlags =85
                    Left =5760
                    Top =120
                    Width =885
                    Height =210
                    Name ="Label7"
                    Caption ="Jumpheight"
                End
            End
        End
        Begin Section
            Height =300
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin TextBox
                    OverlapFlags =85
                    Left =60
                    Top =60
                    Width =1020
                    Name ="Order"
                    ControlSource ="Order"
                End
                Begin ComboBox
                    OverlapFlags =85
                    ColumnCount =4
                    ListRows =20
                    ListWidth =4320
                    Left =1380
                    Top =60
                    Width =3960
                    TabIndex =1
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"100\""
                    Name ="TitleGroupID"
                    ControlSource ="TitleGroupID"
                    RowSourceType ="Table/Query"
                    RowSource ="l_tblTitleGroupDef"
                    ColumnWidths ="0;5760"
                    BaseInfo ="\"l_tblTitleGroupDef\";\"l_tblTitleGroupDef\";\"\";\"TitleGroupID\";\"Name\";\"P"
                        "rimaryKey\""
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    ListWidth =1440
                    Left =5460
                    Top =60
                    TabIndex =2
                    Name ="Combo12"
                    ControlSource ="JumpHeightCD"
                    RowSourceType ="Value List"
                    RowSource ="4;8;12;16;20;24"
                    ColumnWidths ="1440"
                End
            End
        End
        Begin FormFooter
            Height =360
            BackColor =-2147483633
            Name ="FormFooter"
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit
Function GetNextOrderNum(RunningOrderID As Variant) As Integer

  Dim ssql As String
  Dim db As Database, rs As Recordset
  Dim iNextJobItem As Integer
  
  Rem On Error GoTo GetNextJobItemNum_Err
  
  ssql = "SELECT max(order) as m FROM l_tblRunningOrderEntry WHERE ([RunningOrderID] = " & RunningOrderID & ") WITH OWNERACCESS OPTION;"
  Set db = CurrentDb()
  Debug.Print "query is ", ssql
  Set rs = db.OpenRecordset(ssql, dbOpenSnapshot)
  If Not (rs.BOF And rs.EOF) Then
    
    If IsNull(rs("m")) Then
        iNextJobItem = 1
        Debug.Print "Found nothing there: ", iNextJobItem
    Else
        
        iNextJobItem = rs("m")
        Debug.Print "Found something there: ", iNextJobItem
        iNextJobItem = iNextJobItem + 1
    End If
  Else
       
    iNextJobItem = 1
    Debug.Print "Found nothing there: ", iNextJobItem
       
  End If
  
  GetNextOrderNum = iNextJobItem
  
GetNextJobItemNum_Exit:
  On Error Resume Next
  rs.Close: Set rs = Nothing
  db.Close: Set db = Nothing
  Exit Function
  
GetNextJobItemNum_Err:
  Select Case Err
  Case Else
    Debug.Print "Hit error"
    Resume GetNextJobItemNum_Exit:
    Resume
  End Select
  
End Function

Private Sub Form_Current()
    Dim q As String
    Dim id As Integer
    
    
    If IsNull(Me.Order) And Not IsNull(Parent.RunningOrderID) Then
        Me.Order = GetNextOrderNum(Parent.RunningOrderID)
    End If
    
    '
    ' Look for the previous entry, and initialize the titleId to be
    ' the same by default
    '
    Debug.Print "my titleid", Me.TitleGroupID
    If IsNull(Me.TitleGroupID) And Not Me.Parent.NewRecord Then
        
        Dim db As Database, rs As Recordset
        
        q = "SELECT TitleGroupID FROM l_tblRunningOrderEntry where [order] = " & Me.Order - 1 _
            & " AND RunningOrderID = " & Parent.RunningOrderID
        Debug.Print "trying for ", q
        Set db = CurrentDb()
        Debug.Print "query is ", q
        Set rs = db.OpenRecordset(q, dbOpenSnapshot)
        If Not (rs.BOF And rs.EOF) Then
            If Not IsNull(rs!TitleGroupID) Then
                id = rs!TitleGroupID
                Debug.Print "have title ", id
                Me!TitleGroupID = id
                Me.TitleGroupID.Requery
            End If
            
        End If
    End If
End Sub